@using PathfinderCampaignManager.Domain.Entities.Rules

<div class="rule-card @(_IsHovered ? "hovered" : "")" 
     @onmouseover="() => _IsHovered = true"
     @onmouseleave="() => _IsHovered = false"
     @onclick="HandleClick">
    
    <!-- Rule Header -->
    <div class="rule-header">
        <div class="rule-title-section">
            <div class="rule-category-badge">
                <i class="@Rule.Category.GetIconClass()"></i>
                <span>@Rule.Category.GetDisplayName()</span>
            </div>
            <h3 class="rule-title">@Rule.Name</h3>
        </div>
        
        <div class="rule-type-badge @GetContentTypeCssClass()">
            @Rule.ContentType
        </div>
    </div>
    
    <!-- Rule Summary -->
    <div class="rule-summary">
        <p>@Rule.Summary</p>
    </div>
    
    <!-- Rule Metadata -->
    <div class="rule-metadata">
        @if (Rule.Traits.Any())
        {
            <div class="rule-traits">
                @foreach (var trait in Rule.Traits.Take(3))
                {
                    <span class="trait-badge">@trait</span>
                }
                @if (Rule.Traits.Count > 3)
                {
                    <span class="trait-badge more">+@(Rule.Traits.Count - 3)</span>
                }
            </div>
        }
        
        @if (Rule.Tags.Any())
        {
            <div class="rule-tags">
                @foreach (var tag in Rule.Tags.Take(2))
                {
                    <span class="tag-badge">@tag</span>
                }
                @if (Rule.Tags.Count > 2)
                {
                    <span class="tag-badge more">+@(Rule.Tags.Count - 2)</span>
                }
            </div>
        }
    </div>
    
    <!-- Rule Footer -->
    <div class="rule-footer">
        <div class="rule-references">
            @if (Rule.References.Any())
            {
                <i class="fas fa-book-open"></i>
                <span>@Rule.References.First()</span>
            }
        </div>
        
        <div class="rule-actions">
            <button class="btn-icon" title="View Details">
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>
</div>

<style>
.rule-card {
    background: white;
    border: 1px solid var(--border-color);
    border-radius: 0.75rem;
    padding: 1.5rem;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    height: 100%;
}

.rule-card:hover,
.rule-card.hovered {
    border-color: var(--primary-color);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transform: translateY(-2px);
}

.rule-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
}

.rule-title-section {
    flex: 1;
    min-width: 0;
}

.rule-category-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.25rem 0.5rem;
    background: var(--primary-color-10);
    color: var(--primary-color);
    border-radius: 0.375rem;
    font-size: 0.75rem;
    font-weight: 500;
    margin-bottom: 0.5rem;
}

.rule-title {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 1.3;
}

.rule-type-badge {
    padding: 0.375rem 0.75rem;
    border-radius: 0.375rem;
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.025em;
    white-space: nowrap;
}

.rule-type-badge.article {
    background: var(--success-color-10);
    color: var(--success-color);
}

.rule-type-badge.table {
    background: var(--info-color-10);
    color: var(--info-color);
}

.rule-type-badge.formula {
    background: var(--warning-color-10);
    color: var(--warning-color);
}

.rule-type-badge.glossary {
    background: var(--secondary-color-10);
    color: var(--secondary-color);
}

.rule-type-badge.example {
    background: var(--accent-color-10);
    color: var(--accent-color);
}

.rule-summary {
    flex: 1;
}

.rule-summary p {
    margin: 0;
    color: var(--text-secondary);
    line-height: 1.5;
    font-size: 0.9rem;
}

.rule-metadata {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.rule-traits,
.rule-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
}

.trait-badge {
    display: inline-block;
    padding: 0.125rem 0.375rem;
    background: var(--primary-color-10);
    color: var(--primary-color);
    border-radius: 0.25rem;
    font-size: 0.7rem;
    font-weight: 500;
}

.tag-badge {
    display: inline-block;
    padding: 0.125rem 0.375rem;
    background: var(--surface-background);
    color: var(--text-secondary);
    border-radius: 0.25rem;
    font-size: 0.7rem;
    font-weight: 400;
}

.trait-badge.more,
.tag-badge.more {
    opacity: 0.7;
    font-style: italic;
}

.rule-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: auto;
    padding-top: 0.5rem;
    border-top: 1px solid var(--border-color-light);
}

.rule-references {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    color: var(--text-secondary);
    font-size: 0.75rem;
}

.rule-references i {
    font-size: 0.625rem;
}

.rule-actions {
    display: flex;
    gap: 0.25rem;
}

.btn-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border: none;
    background: var(--surface-background);
    color: var(--text-secondary);
    border-radius: 0.25rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-icon:hover {
    background: var(--primary-color);
    color: white;
}

.rule-card:hover .btn-icon {
    background: var(--primary-color-20);
    color: var(--primary-color);
}

.rule-card:hover .btn-icon:hover {
    background: var(--primary-color);
    color: white;
}
</style>